"use strict";!function(e){(e.__loadMonaco||(t=>e.addEventListener("load",t)))(function(){function t(e,t){return n=>{n.innerHTML="",t.forEach(t=>{const o=document.createElement("div");o.className="control";const i=document.createElement("label");i.className="checkbox";const l=document.createElement("span"),c=document.createElement("input");c.id=t.id,c.type="checkbox",c.name=e?"tttie-channels":"tttie-roles",l.innerText=(e?"#":"")+t.name,i.append(c,l),o.appendChild(i),n.appendChild(o)})}}let n=!1;function o(t){const n=[];for(const e of document.querySelectorAll("div.tttie-extension-channel-list"))e.querySelectorAll('input[name="tttie-channels"]').forEach(e=>{e.checked&&n.push(e.id)});const o=[];for(var i of document.querySelectorAll("div.tttie-extension-role-list"))i.querySelectorAll('input[name="tttie-roles"]').forEach(e=>{e.checked&&o.push(e.id)});const l=document.querySelector("input#tttie-extension-store-id");"new"===ttbot.extension||l.value||t(!1);const c=document.querySelector("input#tttie-extension-cmd");let a;(!c.value||c.value.includes(" ")||c.value.length>20)&&t(!1);const r=document.querySelector("textarea#tttie-textarea-code");a=!r&&document.querySelector("div.monaco-container#extension-monaco-container")?e.ttbot.editor.getValue():r.value;const s=document.querySelector("input#tttie-extension-name");(!s.value||s.value.length>100)&&t(!1),t({allowedChannels:n,allowedRoles:o,commandTrigger:c.value,code:a,name:s.value,store:l.value||null})}function i(t,n,o){n||o||("new"===t.id?document.title+=" - New extension":document.title+=" - Extension: "+t.name);const i=document.querySelectorAll(".tttie-title");for(const e of i)"new"===t.id?e.innerText="New extension":e.innerText=t.name;const l=document.querySelector("input#tttie-extension-name");l.value=t.name,l.parentElement.classList.remove("is-loading");for(const e of document.querySelectorAll("div.tttie-extension-channel-list"))e.querySelectorAll('input[name="tttie-channels"]').forEach(e=>{t.allowedChannels.includes(e.id)?e.checked=!0:e.checked=!1});for(const e of document.querySelectorAll("div.tttie-extension-role-list"))e.querySelectorAll('input[name="tttie-roles"]').forEach(e=>{t.allowedRoles.includes(e.id)?e.checked=!0:e.checked=!1});const c=document.querySelector("input#tttie-extension-store-id");c.value=t.store,c.parentElement.classList.remove("is-loading");const a=document.querySelector("input#tttie-extension-cmd");a.value=t.commandTrigger,a.parentElement.classList.remove("is-loading");const r=document.querySelector("textarea#tttie-textarea-code");!r&&document.querySelector("div.monaco-container#extension-monaco-container")?e.ttbot.editor.setValue(t.code):(r.value=t.code,r.parentElement.classList.remove("is-loading"))}const l=document.querySelectorAll("div.tttie-extension-channel-list"),c=document.querySelectorAll("div.tttie-extension-role-list");var a,r,s;e.ttbot.getAvailableChannels().then(n=>(l.forEach(t(!0,n)),e.ttbot.getAvailableRoles(!0))).then(n=>(c.forEach(t(!1,n.filter(t=>t.id!==e.ttbot.guildId))),e.ttbot.getExtension())).then(t=>{i(t),a=document.querySelector("button#save"),r=i,s=o,a.addEventListener("click",()=>{if(n)return!1;n=!0,a.classList.add("is-loading"),a.disabled=!0;const t=e.ttbot.extensionData;s(o=>{const i=(t,o)=>{a.classList.remove("is-loading"),a.disabled=!1,n=!1,r(e.ttbot.extensionData,t,o)};o?e.ttbot.updateExtension(o).then(()=>i(!1,!0)).then(()=>{if("new"===e.ttbot.extension)e.location="/dashboard/"+e.ttbot.guildId+"/extensions/"+e.ttbot.extensionData.id+(e.ttbot.editor?"/monaco":"");else{if(t.name===e.ttbot.extensionData.name)return;e.location.reload()}}):i(!0,!1)})}),((t,n)=>{t.addEventListener("click",()=>{n(e.ttbot.extensionData,!0)})})(document.querySelector("button#reset"),e=>{i(e,!0)})})})}(window);